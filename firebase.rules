{
  "rules": {
    "rooms": {
      "$room": {
        ".read": true,

        // Anyone can create a new room but not overwrite an existing one
        ".write": "!data.exists() || data.exists()",

        "players": {
          "$player": {
            // Allow anyone to write ONLY their own player entry
            ".write": "true",

            ".validate": 
              "newData.hasOnly(['answer','vote','submittedAnswer','voteSubmitted','variant','score'])"
          }
        },

        // Allow anyone in the room to update all gameplay fields
        "impostors": { ".write": true },
        "phase": { ".write": true },
        "timerEnd": { ".write": true },
        "realQuestion": { ".write": true },
        "round": { ".write": true },
        "mode": { ".write": true },
        "currentItem": { ".write": true },
        "turnIndex": { ".write": true },
        "oneWordClues": { ".write": true }
      }
    },

    // Prevent writing literally anywhere else
    ".write": false
  }
}
